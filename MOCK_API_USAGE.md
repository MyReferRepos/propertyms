# Mock API ä½¿ç”¨æŒ‡å—

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. å¯åŠ¨å¼€å‘æœåŠ¡å™¨
```bash
npm run dev
```
æœåŠ¡å™¨å°†åœ¨ http://localhost:5173 å¯åŠ¨

### 2. ä½¿ç”¨æµ‹è¯•è´¦å·ç™»å½•

è®¿é—®ç™»å½•é¡µé¢ï¼šhttp://localhost:5173/sign-in

**æ¨èæµ‹è¯•è´¦å·**ï¼š
- é‚®ç®±ï¼š`admin@example.com`
- å¯†ç ï¼š`NewPass@123`
- è§’è‰²ï¼šè¶…çº§ç®¡ç†å‘˜ï¼ˆæ‹¥æœ‰æ‰€æœ‰æƒé™ï¼‰

### 3. æ¢ç´¢åŠŸèƒ½

ç™»å½•åï¼Œä½ å¯ä»¥ï¼š
- æŸ¥çœ‹å’Œç®¡ç†ç”¨æˆ·åˆ—è¡¨
- ç®¡ç†è§’è‰²å’Œæƒé™
- æµ‹è¯•å®Œæ•´çš„CRUDæ“ä½œ

---

## ğŸ“‹ æ‰€æœ‰æµ‹è¯•è´¦å·

| é‚®ç®± | å¯†ç  | è§’è‰² | æƒé™ |
|------|------|------|------|
| admin@example.com | NewPass@123 | è¶…çº§ç®¡ç†å‘˜ | æ‰€æœ‰æƒé™ |
| jane.smith@example.com | Password123! | ç®¡ç†å‘˜ | ç”¨æˆ·å’Œå†…å®¹ç®¡ç† |
| manager@example.com | Manager123! | ç»ç† | ç”¨æˆ·æŸ¥çœ‹å’Œå†…å®¹ç®¡ç† |
| user@example.com | User123! | æ™®é€šç”¨æˆ· | åŸºç¡€æŸ¥çœ‹æƒé™ |
| john.doe@example.com | Password123! | æ™®é€šç”¨æˆ· | åŸºç¡€æƒé™ |

---

## ğŸ”Œ API ç«¯ç‚¹

### è®¤è¯ç›¸å…³
```
POST   /api/auth/login              # ç”¨æˆ·ç™»å½•
POST   /api/auth/logout             # ç”¨æˆ·ç™»å‡º
POST   /api/auth/refresh            # åˆ·æ–°Token
GET    /api/auth/profile            # è·å–å½“å‰ç”¨æˆ·ä¿¡æ¯
POST   /api/auth/forgot-password    # å¿˜è®°å¯†ç 
POST   /api/auth/reset-password     # é‡ç½®å¯†ç 
```

### ç”¨æˆ·ç®¡ç†
```
GET    /api/users                   # è·å–ç”¨æˆ·åˆ—è¡¨ï¼ˆæ”¯æŒåˆ†é¡µã€æœç´¢ã€è¿‡æ»¤ï¼‰
GET    /api/users/:id               # è·å–å•ä¸ªç”¨æˆ·
POST   /api/users                   # åˆ›å»ºç”¨æˆ·
PUT    /api/users/:id               # æ›´æ–°ç”¨æˆ·
DELETE /api/users/:id               # åˆ é™¤ç”¨æˆ·
POST   /api/users/batch-delete      # æ‰¹é‡åˆ é™¤ç”¨æˆ·
PATCH  /api/users/:id/status        # ä¿®æ”¹ç”¨æˆ·çŠ¶æ€
```

### è§’è‰²ç®¡ç†
```
GET    /api/roles                   # è·å–è§’è‰²åˆ—è¡¨
GET    /api/roles/:id               # è·å–å•ä¸ªè§’è‰²
POST   /api/roles                   # åˆ›å»ºè§’è‰²
PUT    /api/roles/:id               # æ›´æ–°è§’è‰²
DELETE /api/roles/:id               # åˆ é™¤è§’è‰²
```

### æƒé™ç®¡ç†
```
GET    /api/permissions             # è·å–æƒé™åˆ—è¡¨
GET    /api/permissions/tree        # è·å–æƒé™æ ‘ç»“æ„
GET    /api/permissions/:id         # è·å–å•ä¸ªæƒé™
```

---

## ğŸ’¡ ä½¿ç”¨ç¤ºä¾‹

### ç¤ºä¾‹1: ç™»å½•
```typescript
import { authService } from '@/lib/auth'

// ç™»å½•
const response = await authService.login({
  email: 'admin@example.com',
  password: 'NewPass@123'
})

// response.user åŒ…å«ç”¨æˆ·ä¿¡æ¯
// response.accessToken ç”¨äºåç»­è¯·æ±‚
```

### ç¤ºä¾‹2: è·å–ç”¨æˆ·åˆ—è¡¨
```typescript
import { http } from '@/lib/api'

// è·å–ç¬¬1é¡µçš„10æ¡ç”¨æˆ·æ•°æ®
const response = await http.get('/users?page=1&pageSize=10')

// response.data.data åŒ…å«ç”¨æˆ·æ•°ç»„
// response.data.total åŒ…å«æ€»ç”¨æˆ·æ•°
```

### ç¤ºä¾‹3: åˆ›å»ºç”¨æˆ·
```typescript
import { http } from '@/lib/api'

const newUser = await http.post('/users', {
  username: 'newuser',
  email: 'newuser@example.com',
  phone: '+1234567890',
  firstName: 'New',
  lastName: 'User',
  status: 'active',
  roles: ['role-4'], // Userè§’è‰²ID
  department: 'IT',
  position: 'Developer'
})
```

---

## ğŸ” è°ƒè¯•æŠ€å·§

### 1. æŸ¥çœ‹APIè¯·æ±‚
æ‰“å¼€æµè§ˆå™¨å¼€å‘è€…å·¥å…· â†’ Network æ ‡ç­¾ï¼Œè¿‡æ»¤ "api" å¯ä»¥çœ‹åˆ°æ‰€æœ‰APIè¯·æ±‚å’Œå“åº”

### 2. æŸ¥çœ‹æ§åˆ¶å°æ—¥å¿—
åœ¨å¼€å‘æ¨¡å¼ä¸‹ï¼Œæ‰€æœ‰APIè¯·æ±‚éƒ½ä¼šåœ¨æ§åˆ¶å°è¾“å‡ºï¼š
```
[API Request] POST /api/auth/login
[API Response] /api/auth/login {...}
```

### 3. ä½¿ç”¨æµ‹è¯•è„šæœ¬
è¿è¡Œè‡ªåŠ¨åŒ–æµ‹è¯•è„šæœ¬éªŒè¯æ‰€æœ‰APIï¼š
```bash
node test-mock-api.mjs
```

---

## ğŸ¯ åŠŸèƒ½ç‰¹ç‚¹

### âœ… å®Œæ•´çš„è®¤è¯æµç¨‹
- JWTé£æ ¼çš„Tokenæœºåˆ¶
- è‡ªåŠ¨Tokenåˆ·æ–°
- 401é”™è¯¯è‡ªåŠ¨å¤„ç†
- ç™»å‡ºåæ¸…ç†æœ¬åœ°å­˜å‚¨

### âœ… RBACæƒé™ç³»ç»Ÿ
- ä¸‰å±‚æƒé™æ¨¡å‹ï¼ˆPermission â†’ Role â†’ Userï¼‰
- 5ä¸ªé¢„è®¾è§’è‰²
- 15ä¸ªæƒé™ç‚¹
- 5ä¸ªåŠŸèƒ½æ¨¡å—

### âœ… æ•°æ®æŒä¹…åŒ–ï¼ˆä¼šè¯çº§ï¼‰
- ç”¨æˆ·åˆ›å»º/ç¼–è¾‘/åˆ é™¤ä¼šåœ¨å½“å‰ä¼šè¯ä¿æŒ
- åˆ·æ–°é¡µé¢åæ¢å¤åˆå§‹æ•°æ®
- é€‚åˆå¼€å‘å’Œæ¼”ç¤º

### âœ… å®Œæ•´çš„é”™è¯¯å¤„ç†
- 400 - è¯·æ±‚å‚æ•°é”™è¯¯
- 401 - æœªæˆæƒï¼ˆTokenæ— æ•ˆï¼‰
- 403 - æƒé™ä¸è¶³
- 404 - èµ„æºä¸å­˜åœ¨
- 500 - æœåŠ¡å™¨é”™è¯¯

---

## ğŸ“¦ é¡¹ç›®ç»“æ„

```
src/
â”œâ”€â”€ mocks/                      # Mock APIå®ç°
â”‚   â”œâ”€â”€ mockPlugin.ts          # Viteæ’ä»¶ï¼ˆAPIæ‹¦æˆªå™¨ï¼‰
â”‚   â”œâ”€â”€ utils.ts               # å·¥å…·å‡½æ•°ï¼ˆTokenç”Ÿæˆç­‰ï¼‰
â”‚   â”œâ”€â”€ handlers/              # APIå¤„ç†å™¨
â”‚   â”‚   â””â”€â”€ auth.ts           # è®¤è¯ç›¸å…³å¤„ç†å™¨
â”‚   â””â”€â”€ data/                  # Mockæ•°æ®
â”‚       â”œâ”€â”€ users.ts          # ç”¨æˆ·æ•°æ®
â”‚       â”œâ”€â”€ roles.ts          # è§’è‰²æ•°æ®
â”‚       â””â”€â”€ permissions.ts    # æƒé™æ•°æ®
â”‚
â”œâ”€â”€ lib/
â”‚   â”œâ”€â”€ api/                   # APIå®¢æˆ·ç«¯
â”‚   â”‚   â”œâ”€â”€ client.ts         # Axioså®ä¾‹
â”‚   â”‚   â”œâ”€â”€ config.ts         # APIé…ç½®
â”‚   â”‚   â”œâ”€â”€ interceptors.ts   # è¯·æ±‚/å“åº”æ‹¦æˆªå™¨
â”‚   â”‚   â””â”€â”€ types.ts          # APIç±»å‹å®šä¹‰
â”‚   â”‚
â”‚   â””â”€â”€ auth/                  # è®¤è¯æ¨¡å—
â”‚       â”œâ”€â”€ auth-service.ts   # è®¤è¯æœåŠ¡
â”‚       â”œâ”€â”€ auth-store.ts     # è®¤è¯çŠ¶æ€ç®¡ç†
â”‚       â””â”€â”€ types.ts          # è®¤è¯ç±»å‹å®šä¹‰
â”‚
â””â”€â”€ features/
    â”œâ”€â”€ auth/                  # è®¤è¯ç›¸å…³é¡µé¢
    â””â”€â”€ users/                 # ç”¨æˆ·ç®¡ç†ç›¸å…³é¡µé¢
```

---

## ğŸ”§ é…ç½®

### API Base URL
åœ¨ `src/lib/api/config.ts` ä¸­é…ç½®ï¼š

```typescript
export const API_CONFIG = {
  baseURL: import.meta.env.VITE_API_BASE_URL || '/api',
  timeout: 30000,
  // ...
}
```

### ç¯å¢ƒå˜é‡
åˆ›å»º `.env` æ–‡ä»¶ï¼ˆå¯é€‰ï¼‰ï¼š
```bash
# APIåŸºç¡€URLï¼ˆé»˜è®¤ä¸º /apiï¼‰
VITE_API_BASE_URL=/api
```

---

## ğŸš¨ æ³¨æ„äº‹é¡¹

### 1. Mockæ•°æ®é‡ç½®
- æ¯æ¬¡åˆ·æ–°é¡µé¢ï¼ŒMockæ•°æ®ä¼šé‡ç½®ä¸ºåˆå§‹çŠ¶æ€
- è¿™æ˜¯æ­£å¸¸çš„ï¼Œå› ä¸ºæ•°æ®å­˜å‚¨åœ¨å†…å­˜ä¸­

### 2. Tokenæœ‰æ•ˆæœŸ
- accessToken: 1å°æ—¶
- refreshToken: 7å¤©
- Tokenè¿‡æœŸåä¼šè‡ªåŠ¨åˆ·æ–°

### 3. ç³»ç»Ÿè§’è‰²ä¿æŠ¤
- Super Adminè§’è‰²æ˜¯ç³»ç»Ÿè§’è‰²ï¼Œä¸èƒ½åˆ é™¤
- æœ‰ç”¨æˆ·åˆ†é…çš„è§’è‰²ä¸èƒ½åˆ é™¤

### 4. å¼€å‘ç¯å¢ƒä¸“ç”¨
- Mock APIä»…åœ¨å¼€å‘ç¯å¢ƒå¯ç”¨
- ç”Ÿäº§ç¯å¢ƒä¼šä½¿ç”¨çœŸå®çš„API

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [APIè§„èŒƒæ–‡æ¡£](./API_SPEC.md) - å®Œæ•´çš„APIæ¥å£å®šä¹‰
- [æµ‹è¯•æŠ¥å‘Š](./MOCK_API_TESTING.md) - è¯¦ç»†çš„æµ‹è¯•ç»“æœ
- [æµ‹è¯•è„šæœ¬](./test-mock-api.mjs) - è‡ªåŠ¨åŒ–æµ‹è¯•

---

## ğŸ†˜ å¸¸è§é—®é¢˜

### Q: ä¸ºä»€ä¹ˆç™»å½•ååˆ·æ–°é¡µé¢å°±é€€å‡ºäº†ï¼Ÿ
A: æ£€æŸ¥æµè§ˆå™¨çš„localStorageï¼ŒTokenåº”è¯¥ä¼šè¢«ä¿å­˜ã€‚å¦‚æœæ²¡æœ‰ï¼Œå¯èƒ½æ˜¯storageé…ç½®é—®é¢˜ã€‚

### Q: APIè¯·æ±‚è¿”å›404ï¼Ÿ
A: ç¡®ä¿è¯·æ±‚URLä»¥ `/api` å¼€å¤´ï¼Œä¾‹å¦‚ `/api/auth/login` è€Œä¸æ˜¯ `/auth/login`

### Q: Tokenè¿‡æœŸæ€ä¹ˆåŠï¼Ÿ
A: ç³»ç»Ÿä¼šè‡ªåŠ¨å°è¯•åˆ·æ–°Tokenã€‚å¦‚æœåˆ·æ–°å¤±è´¥ï¼Œä¼šè‡ªåŠ¨è·³è½¬åˆ°ç™»å½•é¡µã€‚

### Q: å¦‚ä½•æ·»åŠ æ–°çš„Mockæ•°æ®ï¼Ÿ
A: ç¼–è¾‘ `src/mocks/data/` ä¸‹çš„æ–‡ä»¶ï¼Œæ·»åŠ æ–°çš„ç”¨æˆ·ã€è§’è‰²æˆ–æƒé™ã€‚

---

**ç¥å¼€å‘é¡ºåˆ©ï¼** ğŸ‰

å¦‚æœ‰é—®é¢˜ï¼Œè¯·æŸ¥çœ‹æµ‹è¯•æŠ¥å‘Šæˆ–APIè§„èŒƒæ–‡æ¡£ã€‚
